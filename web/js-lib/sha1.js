/* A JavaScript implementation of the SHA-1, as defined in FIPS PUB 180-2
 * Version 1.11 Copyright Brian Turek 2008
 * Distributed under the BSD License
 * See http://jssha.sourceforge.net/ for more information
 *
 * Several functions taken from Paul Johnson
 */
function jsSHA(G){jsSHA.charSize=8;jsSHA.b64pad="";jsSHA.hexCase=0;var H=null;var E=function(R){var P=[];var N=(1<<jsSHA.charSize)-1;var Q=R.length*jsSHA.charSize;for(var O=0;O<Q;O+=jsSHA.charSize){P[O>>5]|=(R.charCodeAt(O/jsSHA.charSize)&N)<<(32-jsSHA.charSize-O%32)}return P};var I=G.length*jsSHA.charSize;var F=E(G);var L=function(Q){var P=jsSHA.hexCase?"0123456789ABCDEF":"0123456789abcdef";var R="";var O=Q.length*4;for(var N=0;N<O;N++){R+=P.charAt((Q[N>>2]>>((3-N%4)*8+4))&15)+P.charAt((Q[N>>2]>>((3-N%4)*8))&15)}return R};var M=function(R){var P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var T="";var Q=R.length*4;for(var O=0;O<Q;O+=3){var S=(((R[O>>2]>>8*(3-O%4))&255)<<16)|(((R[O+1>>2]>>8*(3-(O+1)%4))&255)<<8)|((R[O+2>>2]>>8*(3-(O+2)%4))&255);for(var N=0;N<4;N++){if(O*8+N*6>R.length*32){T+=jsSHA.b64pad}else{T+=P.charAt((S>>6*(3-N))&63)}}}return T};var C=function(N,O){if(O<32){return(N<<O)|(N>>>(32-O))}else{return N}};var D=function(N,P,O){return N^P^O};var A=function(N,P,O){return(N&P)^(~N&O)};var B=function(N,P,O){return(N&P)^(N&O)^(P&O)};var K=function(N,Q){var P=(N&65535)+(Q&65535);var O=(N>>>16)+(Q>>>16)+(P>>>16);return((O&65535)<<16)|(P&65535)};var J=function(){var O=[];var Y,X,U,S,R;var P;var Z=[1732584193,4023233417,2562383102,271733878,3285377520];var V=[1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782];var g=F.slice();g[I>>5]|=128<<(24-I%32);g[((I+1+64>>9)<<4)+15]=I;var N=g.length;for(var Q=0;Q<N;Q+=16){Y=Z[0];X=Z[1];U=Z[2];S=Z[3];R=Z[4];for(var f=0;f<80;f++){if(f<16){O[f]=g[f+Q]}else{O[f]=C(O[f-3]^O[f-8]^O[f-14]^O[f-16],1)}if(f<20){P=K(K(K(K(C(Y,5),A(X,U,S)),R),V[f]),O[f])}else{if(f<40){P=K(K(K(K(C(Y,5),D(X,U,S)),R),V[f]),O[f])}else{if(f<60){P=K(K(K(K(C(Y,5),B(X,U,S)),R),V[f]),O[f])}else{P=K(K(K(K(C(Y,5),D(X,U,S)),R),V[f]),O[f])}}}R=S;S=U;U=C(X,30);X=Y;Y=P}Z[0]=K(Y,Z[0]);Z[1]=K(X,Z[1]);Z[2]=K(U,Z[2]);Z[3]=K(S,Z[3]);Z[4]=K(R,Z[4])}return Z};this.getHash=function(O){var N=null;if(H===null){H=H=J()}switch(O){case"HEX":N=L;break;case"B64":N=M;break;default:return"FORMAT NOT RECOGNIZED"}return N(H)}};
